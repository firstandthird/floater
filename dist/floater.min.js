/*!
 * floater - a plugin to make element float on the screen
 * v0.3.0
 * https://github.com/jgallen23/floater
 * copyright JGA 2013
 * MIT License
*/
(function(t,i){var s=0,e=function(t){this.obj=t};e.prototype.__init=function(t){i.extend(this,this.obj),this.id=s++,this.obj.defaults=this.obj.defaults||{},i.extend(this,this.obj.defaults,t),i("body").trigger("FidelPreInit",this),this.setElement(this.el||i("<div/>")),this.init&&this.init(),i("body").trigger("FidelPostInit",this)},e.prototype.eventSplitter=/^(\w+)\s*(.*)$/,e.prototype.setElement=function(t){this.el=t,this.getElements(),this.delegateEvents(),this.dataElements(),this.delegateActions()},e.prototype.find=function(t){return this.el.find(t)},e.prototype.proxy=function(t){return i.proxy(t,this)},e.prototype.getElements=function(){if(this.elements)for(var t in this.elements){var i=this.elements[t];this[i]=this.find(t)}},e.prototype.dataElements=function(){var t=this;this.find("[data-element]").each(function(s,e){var o=i(e),h=o.data("element");t[h]=o})},e.prototype.delegateEvents=function(){if(this.events)for(var t in this.events){var i=this.events[t],s=t.match(this.eventSplitter),e=s[1],o=s[2],h=this.proxy(this[i]);""===o?this.el.on(e,h):this[o]&&"function"!=typeof this[o]?this[o].on(e,h):this.el.on(e,o,h)}},e.prototype.delegateActions=function(){var t=this;t.el.on("click","[data-action]",function(s){var e=i(this),o=e.attr("data-action");t[o]&&t[o](s,e)})},e.prototype.on=function(t,i){this.el.on(t+".fidel"+this.id,i)},e.prototype.one=function(t,i){this.el.one(t+".fidel"+this.id,i)},e.prototype.emit=function(t,i,s){var e=s?".fidel"+this.id:"";this.el.trigger(t+e,i)},e.prototype.hide=function(){if(this.views)for(var t in this.views)this.views[t].hide();this.el.hide()},e.prototype.show=function(){if(this.views)for(var t in this.views)this.views[t].show();this.el.show()},e.prototype.destroy=function(){this.el.empty(),this.emit("destroy"),this.el.unbind(".fidel"+this.id)},e.declare=function(t){var i=function(t,i){this.__init(t,i)};return i.prototype=new e(t),i},e.onPreInit=function(t){i("body").on("FidelPreInit",function(i,s){t.call(s)})},e.onPostInit=function(t){i("body").on("FidelPostInit",function(i,s){t.call(s)})},i.declare=function(t,s){i.fn[t]=function(){var o,h,n=Array.prototype.slice.call(arguments),l=n.shift();return h=this.each(function(){var h=i(this),a=h.data(t);if(!a){var f=e.declare(s),r=i.extend({},l,{el:h});a=new f(r),h.data(t,a)}"string"==typeof l&&(o=a[l].apply(a,n))}),o||h},i.fn[t].defaults=s.defaults||{}},i.Fidel=e,t.Fidel=e})(window,window.jQuery||window.Zepto),function(t){t.declare("floater",{defaults:{topPadding:0,stopPoint:-1,stopElement:null,startPoint:-1,relative:!1,offsetX:0,offsetY:0,stopOffset:0,debug:!1,autoRecalc:!1,floatClass:"floating"},init:function(){this.enabled=!0,this.floating=!1,this.recalcTimeout=null,this.recalc(),t(window).on("scroll",this.proxy(this.onScroll)),this.onScroll()},recalc:function(){if(!this.floating){this.resetStyles={position:this.el.css("position"),top:this.el.css("top"),left:this.el.css("left"),width:this.el.css("width")};var t=this.el.offset();this.topPadding=parseInt(this.topPadding,10),this.startPoint=t.top-this.topPadding,this.height=this.el.outerHeight(!0),this.stopElement&&(this.stopPoint=this.stopElement.offset().top),this.debug&&this.showDebug()}},setStartPoint:function(t){this.startPoint=t,this.debug&&this.showDebug()},setStopPoint:function(t){this.stopPoint=t,this.debug&&this.showDebug()},showDebug:function(){t(".floater-debug").remove();var i=function(i){t("<div/>").css({position:"absolute",height:"1px",width:"100%",background:"red",top:i}).addClass("floater-debug").appendTo("body")};i(this.startPoint),i(this.stopPoint)},createPlaceholder:function(){var i=this.el[0].className||"";return t("<div/>").addClass("floater-placeholder "+i).css({width:this.el.css("width"),height:this.el.css("height"),visibility:"hidden"})},startFloat:function(){if(!this.floating){this.floating=!0;var t=this.el.offset();this.el.prev().hasClass("floater-placeholder")||this.el.before(this.createPlaceholder()),this.el.css({position:"fixed",top:this.topPadding+"px",left:t.left+this.offsetX,width:this.el.css("width")}),this.floatClass&&this.el.addClass(this.floatClass),this.emit("floatStart")}},stopFloat:function(){this.floating&&(this.floating=!1,this.el.prev().remove(),this.el.css({position:"",top:"",left:"",width:""}),this.floatClass&&this.el.removeClass(this.floatClass),this.emit("floatStop"))},freezeFloat:function(t){this.floating&&(this.floating=!1,this.el.css({position:"absolute",top:t,left:"",width:this.el.css("width")}),this.emit("floatStop"))},onScroll:function(){if(this.enabled){this.autoRecalc&&(clearTimeout(this.recalcTimeout),this.recalcTimeout=setTimeout(this.proxy(this.recalc),500));var i=t(window).scrollTop();i>this.startPoint?-1!=this.stopPoint&&i+this.height+this.topPadding>this.stopPoint?this.floating&&this.freezeFloat(this.stopPoint-this.height-this.stopOffset):this.floating||this.startFloat():this.floating&&this.startPoint>i&&this.stopFloat()}},on:function(){this.enabled=!0,this.onScroll()},off:function(){this.stopFloat(),this.enabled=!1}})}(window.jQuery||window.Zepto);