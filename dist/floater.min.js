/*!
 * floater - a plugin to make element float on the screen
 * v0.2.3
 * https://github.com/jgallen23/floater
 * copyright JGA 2013
 * MIT License
*/
(function(e,t){var n=0,r=function(e){this.obj=e};r.prototype.__init=function(e){t.extend(this,this.obj),this.id=n++,this.obj.defaults=this.obj.defaults||{},t.extend(this,this.obj.defaults,e),t("body").trigger("FidelPreInit",this),this.setElement(this.el||t("<div/>")),this.init&&this.init(),t("body").trigger("FidelPostInit",this)},r.prototype.eventSplitter=/^(\w+)\s*(.*)$/,r.prototype.setElement=function(e){this.el=e,this.getElements(),this.delegateEvents(),this.dataElements(),this.delegateActions()},r.prototype.find=function(e){return this.el.find(e)},r.prototype.proxy=function(e){return t.proxy(e,this)},r.prototype.getElements=function(){if(!this.elements)return;for(var e in this.elements){var t=this.elements[e];this[t]=this.find(e)}},r.prototype.dataElements=function(){var e=this;this.find("[data-element]").each(function(n,r){var i=t(r),s=i.data("element");e[s]=i})},r.prototype.delegateEvents=function(){var e=this;if(!this.events)return;for(var t in this.events){var n=this.events[t],r=t.match(this.eventSplitter),i=r[1],s=r[2],o=this.proxy(this[n]);s===""?this.el.on(i,o):this[s]&&typeof this[s]!="function"?this[s].on(i,o):this.el.on(i,s,o)}},r.prototype.delegateActions=function(){var e=this;e.el.on("click","[data-action]",function(n){var r=t(this),i=r.attr("data-action");e[i]&&e[i](n,r)})},r.prototype.on=function(e,t){this.el.on(e+".fidel"+this.id,t)},r.prototype.one=function(e,t){this.el.one(e+".fidel"+this.id,t)},r.prototype.emit=function(e,t,n){var r=n?".fidel"+this.id:"";this.el.trigger(e+r,t)},r.prototype.hide=function(){if(this.views)for(var e in this.views)this.views[e].hide();this.el.hide()},r.prototype.show=function(){if(this.views)for(var e in this.views)this.views[e].show();this.el.show()},r.prototype.destroy=function(){this.el.empty(),this.emit("destroy"),this.el.unbind(".fidel"+this.id)},r.declare=function(e){var t=function(e,t){this.__init(e,t)};return t.prototype=new r(e),t},r.onPreInit=function(e){t("body").on("FidelPreInit",function(t,n){e.call(n)})},r.onPostInit=function(e){t("body").on("FidelPostInit",function(t,n){e.call(n)})},t.declare=function(e,n){t.fn[e]=function(){var i=Array.prototype.slice.call(arguments),s=i.shift(),o,u;return u=this.each(function(){var u=t(this),a=u.data(e);if(!a){var f=r.declare(n),l=t.extend({},s,{el:u});a=new f(l),u.data(e,a)}typeof s=="string"&&(o=a[s].apply(a,i))}),o||u},t.fn[e].defaults=n.defaults||{}},t.Fidel=r,e.Fidel=r})(window,window.jQuery||window.Zepto),function(e){e.declare("floater",{defaults:{topPadding:0,stopPoint:-1,startPoint:-1,relative:!1,offsetX:0,offsetY:0,stopOffset:0,debug:!1},init:function(){this.enabled=!0,this.resetStyles={position:this.el.css("position"),top:this.el.css("top"),left:this.el.css("left"),width:this.el.css("width")};var t=this.el.offset();this.topPadding=parseInt(this.topPadding,10),this.startPoint=this.startPoint==-1?t.top-this.topPadding:this.startPoint,this.height=this.el.outerHeight(!0),typeof this.stopPoint=="object"&&this.stopPoint.length&&(this.stopPoint=this.stopPoint.offset().top),this.floating=!1,e(window).on("scroll",this.proxy(this.onScroll)),this.onScroll(),this.debug&&this.showDebug()},setStartPoint:function(e){this.startPoint=e,this.debug&&this.showDebug()},setStopPoint:function(e){this.stopPoint=e,this.debug&&this.showDebug()},showDebug:function(){e(".floater-debug").remove();var t=function(t){e("<div/>").css({position:"absolute",height:"1px",width:"100%",background:"red",top:t}).addClass("floater-debug").appendTo("body")};t(this.startPoint),t(this.stopPoint)},createPlaceholder:function(){var t=this.el[0].className||"";return e("<div/>").addClass("floater-placeholder "+t).css({width:this.el.css("width"),height:this.el.css("height"),visibility:"hidden"})},startFloat:function(){if(this.floating)return;this.floating=!0;var e=this.el.offset();this.el.prev().hasClass("floater-placeholder")||this.el.before(this.createPlaceholder()),this.el.css({position:"fixed",top:this.topPadding+"px",left:e.left+this.offsetX,width:this.el.css("width")}),this.emit("floatStart")},stopFloat:function(e){if(!this.floating)return;this.floating=!1,this.el.prev().remove(),this.el.css({position:"",top:"",left:"",width:""}),this.emit("floatStop")},freezeFloat:function(e){if(!this.floating)return;this.floating=!1,this.el.css({position:"absolute",top:e,left:"",width:this.el.css("width")}),this.emit("floatStop")},onScroll:function(t){if(!this.enabled)return;var n=e(window).scrollTop();n>this.startPoint?this.stopPoint!=-1&&n+this.height+this.topPadding>this.stopPoint?this.floating&&this.freezeFloat(this.stopPoint-this.height-this.stopOffset):this.floating||this.startFloat():this.floating&&n<this.startPoint&&this.stopFloat()},on:function(){this.enabled=!0,this.onScroll()},off:function(){this.stopFloat(),this.enabled=!1}})}(window.jQuery||window.Zepto);